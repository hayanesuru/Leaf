From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Taiyou06 <kaandindar21@gmail.com>
Date: Thu, 7 Nov 2024 21:50:47 +0100
Subject: [PATCH] Lithium: fast util

This patch is based on the following mixins:
* "net/caffeinemc/mods/lithium/mixin/math/fast_util/AABBMixin.java"
* "net/caffeinemc/mods/lithium/mixin/math/fast_util/AxisCycleDirectionMixin.java"
* "net/caffeinemc/mods/lithium/mixin/math/fast_util/DirectionMixin.java"
By: 2No2Name <2No2Name@web.de>
As part of: Lithium (https://github.com/CaffeineMC/lithium)
Licensed under: LGPL-3.0 (https://www.gnu.org/licenses/lgpl-3.0.html)

diff --git a/net/minecraft/core/AxisCycle.java b/net/minecraft/core/AxisCycle.java
index 0dd0313e507614109abbd469de7eecda9f6d55b0..e995672aecf5d48e9969639ea83ff0b2a49f656d 100644
--- a/net/minecraft/core/AxisCycle.java
+++ b/net/minecraft/core/AxisCycle.java
@@ -35,7 +35,17 @@ public enum AxisCycle {
 
         @Override
         public Direction.Axis cycle(Direction.Axis axis) {
-            return AXIS_VALUES[Math.floorMod(axis.ordinal() + 1, 3)];
+            // Leaf start - Lithium - fast util
+            return switch (axis.ordinal()) {
+                case 0 -> //X
+                    Direction.Axis.Y;
+                case 1 -> //Y
+                    Direction.Axis.Z;
+                case 2 -> //Z
+                    Direction.Axis.X;
+                default -> throw new IllegalArgumentException();
+            };
+            // Leaf end - Lithium - fast util
         }
 
         @Override
@@ -56,7 +66,17 @@ public enum AxisCycle {
 
         @Override
         public Direction.Axis cycle(Direction.Axis axis) {
-            return AXIS_VALUES[Math.floorMod(axis.ordinal() - 1, 3)];
+            // Leaf start - Lithium - fast util
+            return switch (axis.ordinal()) {
+                case 0 -> //X
+                    Direction.Axis.Z;
+                case 1 -> //Y
+                    Direction.Axis.X;
+                case 2 -> //Z
+                    Direction.Axis.Y;
+                default -> throw new IllegalArgumentException();
+            };
+            // Leaf end - Lithium - fast util
         }
 
         @Override
diff --git a/net/minecraft/core/Direction.java b/net/minecraft/core/Direction.java
index 0206ca3d71ec2aefd9c22ad7e828f565f6b4528c..657f77d9fb25f37083d06694de08864f6d4dc6b7 100644
--- a/net/minecraft/core/Direction.java
+++ b/net/minecraft/core/Direction.java
@@ -225,7 +225,7 @@ public enum Direction implements StringRepresentable, ca.spottedleaf.moonrise.pa
     }
 
     public Direction getOpposite() {
-        return this.opposite; // Paper - optimise collisions
+        return VALUES[this.oppositeIndex]; // Leaf - Lithium - fast util
     }
 
     public Direction getClockWise(Direction.Axis axis) {
@@ -357,7 +357,7 @@ public enum Direction implements StringRepresentable, ca.spottedleaf.moonrise.pa
     }
 
     public static Direction getRandom(RandomSource random) {
-        return Util.getRandom(VALUES, random);
+        return VALUES[random.nextInt(VALUES.length)]; // Leaf - Lithium - fast util
     }
 
     public static Direction getApproximateNearest(double x, double y, double z) {
@@ -452,7 +452,7 @@ public enum Direction implements StringRepresentable, ca.spottedleaf.moonrise.pa
     }
 
     public static enum Axis implements StringRepresentable, Predicate<Direction> {
-        X("x") {
+        X("x") { // Leaf start - Lithium - fast util - diff on change
             @Override
             public int choose(int x, int y, int z) {
                 return x;
@@ -478,31 +478,31 @@ public enum Direction implements StringRepresentable, ca.spottedleaf.moonrise.pa
                 return Direction.WEST;
             }
         },
-        Y("y") {
+        Y("y") { // Leaf start - Lithium - fast util - diff on change
             @Override
             public int choose(int x, int y, int z) {
                 return y;
-            }
+            } // Leaf start - Lithium - fast util - diff on change
 
             @Override
             public double choose(double x, double y, double z) {
                 return y;
-            }
+            } // Leaf start - Lithium - fast util - diff on change
 
             @Override
             public boolean choose(boolean x, boolean y, boolean z) {
                 return y;
-            }
+            } // Leaf start - Lithium - fast util - diff on change
 
             @Override
             public Direction getPositive() {
                 return Direction.UP;
-            }
+            } // Leaf start - Lithium - fast util - diff on change
 
             @Override
             public Direction getNegative() {
                 return Direction.DOWN;
-            }
+            } // Leaf start - Lithium - fast util - diff on change
         },
         Z("z") {
             @Override
@@ -529,7 +529,7 @@ public enum Direction implements StringRepresentable, ca.spottedleaf.moonrise.pa
             public Direction getNegative() {
                 return Direction.NORTH;
             }
-        };
+        }; // Leaf start - Lithium - fast util - diff on change
 
         public static final Direction.Axis[] VALUES = values();
         public static final StringRepresentable.EnumCodec<Direction.Axis> CODEC = StringRepresentable.fromEnum(Direction.Axis::values);
diff --git a/net/minecraft/world/phys/AABB.java b/net/minecraft/world/phys/AABB.java
index 120e432df71eaee94225555d24c82e6d05b34b9f..764ede4beeebf17518bef2409565944cf5f6e149 100644
--- a/net/minecraft/world/phys/AABB.java
+++ b/net/minecraft/world/phys/AABB.java
@@ -80,11 +80,32 @@ public class AABB {
     }
 
     public double min(Direction.Axis axis) {
-        return axis.choose(this.minX, this.minY, this.minZ);
+        // Leaf start - Lithium - fast util
+        return switch (axis.ordinal()) {
+            case 0 -> //X
+                this.minX;
+            case 1 -> //Y
+                this.minY;
+            case 2 -> //Z
+                this.minZ;
+            default -> throw new IllegalArgumentException();
+        };
+
+        // Leaf end - Lithium - fast util
     }
 
     public double max(Direction.Axis axis) {
-        return axis.choose(this.maxX, this.maxY, this.maxZ);
+        // Leaf start - Lithium - fast util
+        return switch (axis.ordinal()) {
+            case 0 -> //X
+                this.maxX;
+            case 1 -> //Y
+                this.maxY;
+            case 2 -> //Z
+                this.maxZ;
+            default -> throw new IllegalArgumentException();
+        };
+        // Leaf end - Lithium - fast util
     }
 
     @Override
