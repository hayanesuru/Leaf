From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Taiyou06 <kaandindar21@gmail.com>
Date: Sat, 22 Mar 2025 00:07:38 +0100
Subject: [PATCH] Optimize addOrUpdateTransientModifier


diff --git a/net/minecraft/world/entity/ai/attributes/AttributeInstance.java b/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
index ceff383d565267edd13a6d9006030b8e1f8053e3..71fb9a61e8d3ac7094d0630aebdc46dbe74dd0ae 100644
--- a/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
+++ b/net/minecraft/world/entity/ai/attributes/AttributeInstance.java
@@ -88,8 +88,11 @@ public class AttributeInstance {
     }
 
     public void addOrUpdateTransientModifier(AttributeModifier modifier) {
-        AttributeModifier attributeModifier = this.modifierById.put(modifier.id(), modifier);
-        if (modifier != attributeModifier) {
+        // First check if we already have the same modifier instance to avoid unnecessary put operations
+        AttributeModifier existingModifier = this.modifierById.get(modifier.id());
+        // Only perform updates if the modifier is new or different
+        if (existingModifier != modifier) {
+            this.modifierById.put(modifier.id(), modifier);
             this.getModifiers(modifier.operation()).put(modifier.id(), modifier);
             this.setDirty();
         }
