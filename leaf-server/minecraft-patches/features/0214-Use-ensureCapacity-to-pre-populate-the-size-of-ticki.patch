From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Taiyou06 <kaandindar21@gmail.com>
Date: Sun, 16 Feb 2025 01:13:04 +0100
Subject: [PATCH] Use ensureCapacity to pre-populate the size of ticking chunks
 list output


diff --git a/net/minecraft/server/level/ChunkMap.java b/net/minecraft/server/level/ChunkMap.java
index 14b2abc51fa5d2caa56adfaf50784296c5668ae6..0813505f96a1a6bb2cbfb05a97c90241f0c5b1c8 100644
--- a/net/minecraft/server/level/ChunkMap.java
+++ b/net/minecraft/server/level/ChunkMap.java
@@ -733,6 +733,11 @@ public class ChunkMap extends ChunkStorage implements ChunkHolder.PlayerProvider
         final int size = tickingChunks.size();
 
         Objects.checkFromToIndex(0, size, raw.length);
+        // Leaf start - Use ensureCapacity to pre-populate the size of ticking chunks list output
+        if (output instanceof ArrayList<LevelChunk> arrayList) {
+            arrayList.ensureCapacity(size);
+        }
+        // Leaf end - Use ensureCapacity to pre-populate the size of ticking chunks list output
         for (int i = 0; i < size; ++i) {
             final LevelChunk levelChunk = raw[i];
 
